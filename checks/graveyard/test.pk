

// in_a_definition = false
// def_builder = None

// if not in_a_definition
//   if empty line
//      ignore line
//   if non empty line
//     store whitespace prefix length
//     in a definition = true
//     create def object
// if in_a_definition
//   if empty line
//      finished_definition (return AST thing)
//      in_a_definition = false
//   if non empty line
//      if whitespace prefix length > def whitespace prefix length
//        parse it, add chunks to current def object
//      else
//        new definition starting
//        finish_definition (return AST thing)
//        leave in_a_definition as-is



exists? /home/dparfitt/.config

exists? /home/dparfitt/.zshrc

waiting for exists? /home/dparfitt/testfile
    before: echo "Before 1"
    after: echo "After 1"


// required params can all be on 1 line
wait for multi_param_test? /home/dparfitt/testfile foo 100x
    named_param1: "xyz" // optional param
    before: echo "Before 1"
    after: echo "After 1"


// but can they be split over multiple lines?
check wait for multi_param_test? /home/dparfitt/testfile
    foo 100x
    named_param1: "xyz" // optional param
    before: echo "Before 1"
    after: echo "After 1"


foobar = {
    exists? /home/dparfitt/.zshrc

    cmd do more stuff
        after: echo "Foo"
        before: echo "Bar"

    cmd do more stuff
        after: echo "Foo"
        before: echo "Bar"

}

exists? /home/dparfitt/core

executable? /home/dparfitt/.cargo/bin/rustc
    before: sudo apt-get install cargo
    after: echo "Installed"

// this would need root or sudo
{

  doc: Wait for nginx to start

  wait until cmd sudo systemctl is-active --quiet nginx
    before: systemctl start nginx
}
